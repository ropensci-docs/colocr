<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="colocr">
<title>Using colocr • colocr</title>
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://docs.ropensci.org/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using colocr">
<meta property="og:description" content="colocr">
<meta property="og:image" content="https://docs.ropensci.org/colocr/logo.png">
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Matomo --><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css">
<script src="https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js" data-cfasync="false"></script><script src="https://ropensci.org/scripts/matomo.js"></script><noscript><p><img src="https://ropensci.matomo.cloud/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt=""></p></noscript>
<!-- End Matomo Code -->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://ropensci.org" class="external-link"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
    <a class="navbar-brand me-2" href="../index.html">colocr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"></ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/using_colocr.html">Using colocr</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ropensci/colocr/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Using colocr</h1>
            <h3 data-toc-skip class="subtitle">An R package for conducting co-localization analysis</h3>
                        <h4 data-toc-skip class="author">Mahmoud Ahmed</h4>
            
            <h4 data-toc-skip class="date">2024-02-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/colocr/blob/HEAD/vignettes/using_colocr.Rmd" class="external-link"><code>vignettes/using_colocr.Rmd</code></a></small>
      <div class="d-none name"><code>using_colocr.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>A few R packages are available for conducting image analysis, which is a very wide topic. As a result, some of us might feel at a loss when all they want to do is a simple co-localization calculations on a small number of microscopy images. This package provides a simple straight forward workflow for loading images, choosing regions of interest (ROIs) and calculating co-localization statistics. Included in the package, is a <a href="https://shiny.rstudio.com" class="external-link">shiny app</a> that can be invoked locally to interactively select the regions of interest in a semi-automatic way. The package is based on the R package <a href="https://CRAN.R-project.org/package=imager" class="external-link"><code>imager</code></a>.</p>
</div>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>To get started, load the required packages and the images. The images below are from <a href="https://en.wikipedia.org/wiki/DU145" class="external-link">DU145</a> cell line and were stained for two proteins; <a href="https://en.wikipedia.org/wiki/Raf_kinase_inhibitor_protein" class="external-link">RKIP</a> and <a href="https://en.wikipedia.org/wiki/MAP1LC3B" class="external-link">LC3</a>. Then, apply the appropriate parameters for choosing the regions of interest using the <code>roi_select</code>. Finally, check the appropriateness of the parameters by highlighting the ROIs on the image.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/colocr">colocr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load images</span></span>
<span><span class="va">fl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'Image0001_.jpg'</span>, package <span class="op">=</span> <span class="st">'colocr'</span><span class="op">)</span></span>
<span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/image_load.html">image_load</a></span><span class="op">(</span><span class="va">fl</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select ROI and show the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">img</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_select.html">roi_select</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">90</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_show.html">roi_show</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_colocr_files/figure-html/getting_started-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The same can be achieved interactively using an accompanying <strong>shiny</strong> app. To launch the app run.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/colocr_app.html">colocr_app</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>The rest of the analysis depends on the particular kind of images. Now, <code>colocr</code> implements two simple co-localization statistics; Pearson’s Coefficient Correlation <a href="https://www.ncbi.nlm.nih.gov/pubmed/20653013" class="external-link">(PCC)</a> and the Manders Overlap Coefficient <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3074624/" class="external-link">(MOC)</a>.</p>
<p>To apply both measures of correlation, we first get the pixel intensities and call <code>roi_test</code> on the merge image.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate co-localization statistics</span></span>
<span><span class="va">img</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_select.html">roi_select</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">90</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_test.html">roi_test</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">'both'</span><span class="op">)</span></span>
<span><span class="co">#&gt;         pcc       moc</span></span>
<span><span class="co">#&gt; 1 0.9049954 0.9833916</span></span></code></pre></div>
<p>The same analysis and more can be conducted using a web interface for the package available <a href="https://mahshaaban.shinyapps.io/colocr_app2/" class="external-link">here</a></p>
</div>
<div class="section level2">
<h2 id="detailed-example">Detailed Example<a class="anchor" aria-label="anchor" href="#detailed-example"></a>
</h2>
<p>The following example uses images from the <a href="https://en.wikipedia.org/wiki/DU145" class="external-link">DU145</a> prostate cancer cell line. In this experiment, the cell line was treated with probes for two proteins <a href="https://en.wikipedia.org/wiki/Raf_kinase_inhibitor_protein" class="external-link">RKIP</a> and <a href="https://en.wikipedia.org/wiki/MAP1LC3B" class="external-link">LC3</a>. The aim of this experiment is to determine, how much of the two proteins are co-localized or co-distributed in the particular cell line.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load required libraries</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/colocr">colocr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># load images</span></span>
<span><span class="va">img</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/image_load.html">image_load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'Image0001_.jpg'</span>, package <span class="op">=</span> <span class="st">'colocr'</span><span class="op">)</span><span class="op">)</span>       <span class="co"># merge</span></span>
<span><span class="va">img1</span> <span class="op">&lt;-</span> <span class="fu">imager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/imager/man/cimg.extract.html" class="external-link">channel</a></span><span class="op">(</span><span class="va">img</span>, <span class="fl">1</span><span class="op">)</span>  <span class="co"># red</span></span>
<span><span class="va">img2</span> <span class="op">&lt;-</span> <span class="fu">imager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/imager/man/cimg.extract.html" class="external-link">channel</a></span><span class="op">(</span><span class="va">img</span>, <span class="fl">2</span><span class="op">)</span>  <span class="co"># green</span></span>
<span></span>
<span><span class="co"># show images</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">img</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">'Merged'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">img1</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">'RKIP'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">img2</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, main <span class="op">=</span> <span class="st">'LC3'</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_colocr_files/figure-html/show_images-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The <code>colocr</code> package provides a straight forward workflow for determining the amount of co-localization. This workflow consists of two steps only:</p>
<ul>
<li>Choosing regions of interest (ROI)</li>
<li>Calculating the correlation between the pixel intensities</li>
</ul>
<p>The first step can be achieved by calling <code>roi_select</code> on the image. In addition, <code>roi_show</code> can be used to visualize the regions that were selected to make sure they match the expectations. Similarly, <code>roi_check</code> can be used to visualize the pixel intensities of the selected regions. The second step is calling <code>roi_test</code> to calculate the co-localization statistics.</p>
<p>The calls to these functions can be piped using <code>%&gt;%</code> to reduce the amount of typing and make the code more readable.</p>
<p><img src="../../../../usr/local/lib/R/site-library/colocr/colocr_app/workflow.png" width="300px" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="choosing-rois">Choosing ROIs<a class="anchor" aria-label="anchor" href="#choosing-rois"></a>
</h3>
<p>The function <code>roi_select</code> relies on different algorithms from the <code>imager</code> package. However, using the functions to select the ROIs doesn’t require any background knowledge in the workings of the algorithms and can be done through trying different parameters and choosing the most appropriate ones. Typically, one wants to select the regions of the image occupied by a cell or a group of cells. However, the package can also be used to select certain areas/structures within the cell if they are distinct enough. By default, the largest contiguous region of the image is selected, more regions can be added using the argument <code>n</code>. The details of the other inputs are documented in the function help page <code><a href="../reference/roi_select.html">?roi_select</a></code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># select regions of interest</span></span>
<span><span class="va">img_rois</span> <span class="op">&lt;-</span> <span class="va">img</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_select.html">roi_select</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></code></pre></div>
<p>This function returns <code>cimg</code> object containing the original input image and an added attribute called <code>label</code> which indicates the selected regions. <code>label</code> is a vector of <code>integer</code>s; with 0 indicating the non-selected pixels and 1 for the selected regions. When the argument <code>n</code> is provided to <code>roi_select</code>, 1 is replaced by <code>integer</code> labels for each of the selected regions separately.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># class of the returned object</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">img_rois</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "cimg"         "imager_array" "numeric"</span></span>
<span><span class="co">#&gt; [1] "cimg"         "imager_array" "numeric"</span></span>
<span></span>
<span><span class="co"># name of added attribut</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">img</span><span class="op">)</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">img_rois</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "class" "dim"</span></span>
<span><span class="co">#&gt; [1] "class" "dim"   "label"</span></span>
<span></span>
<span><span class="co"># str of labels</span></span>
<span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">img_rois</span>, <span class="st">'label'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">label</span><span class="op">)</span></span>
<span><span class="co">#&gt;  num [1:480000] 0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span></span>
<span><span class="co"># unique labels </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">label</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0 1</span></span></code></pre></div>
<p>Now, to make sure these parameters are appropriately encompassing the ROIs, call the <code>roi_show</code> to visualize side by side the original merge picture, a low resolution picture of the ROI and the images from the two different channels highlighted by the ROIs.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># select ROI and show the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">img_rois</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_show.html">roi_show</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_colocr_files/figure-html/call_roi_show-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Both the co-localization statistics implemented in this package quantify different aspects of the linear trend between the pixel intensities from the two channels of the image. Therefore, it is useful to visualize this trend and the distribution of the intensities to make sure the analysis is appropriate.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># show the scatter and density of the pixel values</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">img_rois</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_check.html">roi_check</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_colocr_files/figure-html/call_coloc_show-1.png" width="672" style="display: block; margin: auto;"></p>
<p>Arguably, selecting the regions of interest is the most time consuming step in this kind of analysis. Usually, one has to do this selection by hand when using image analysis software such as <a href="https://imagej.nih.gov/ij/" class="external-link">imageJ</a>. This package only semi-automates this step, but still relies on the user’s judgment on which parameters to use and whether or not the selected ROIs are appropriate. To make life easier, the package provides a simple shiny app to interactively determine these parameters and use it in the rest of the workflow. To launch the app run the following</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># run the shiny app</span></span>
<span><span class="fu"><a href="../reference/colocr_app.html">colocr_app</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>And here is a screen shot from the app after applying the same parameters used previously.</p>
<p><img src="../../../../usr/local/lib/R/site-library/colocr/colocr_app/tests/one_image-expected/001.png" width="600px" style="display: block; margin: auto;"></p>
<p>Although this app was designed to be invoked from within the package to help the users to choose the selection parameters interactively, it’s a stand alone app and can run the same analysis described here. The app can be accessed from the web <a href="https://mahshaaban.shinyapps.io/colocr_app2/" class="external-link">here</a></p>
</div>
<div class="section level3">
<h3 id="calculating-correlation-statistics">Calculating Correlation Statistics<a class="anchor" aria-label="anchor" href="#calculating-correlation-statistics"></a>
</h3>
<p>The two different statistics implemented in this package are the PCC and SCC. The formal description and the rational for using them is detailed elsewhere. Invoking the test is a one function call on the selected regions of interest.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate the co-localization statistics</span></span>
<span><span class="va">tst</span> <span class="op">&lt;-</span> <span class="va">img_rois</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_test.html">roi_test</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">'both'</span><span class="op">)</span></span>
<span><span class="va">tst</span></span>
<span><span class="co">#&gt;         pcc       moc</span></span>
<span><span class="co">#&gt; 1 0.9049954 0.9833916</span></span></code></pre></div>
<p><code>roi_test</code> returns a <code>data.frame</code> with a column for each of the desired statistics. When <code>n</code> is used in the selection of the regions of interest, a separate row is returned for each region.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># str of the roi_test output</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">tst</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    1 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;  $ pcc: num 0.905</span></span>
<span><span class="co">#&gt;  $ moc: num 0.983</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="selecting-a-multiple-regions-in-an-image">Selecting a multiple regions in an image<a class="anchor" aria-label="anchor" href="#selecting-a-multiple-regions-in-an-image"></a>
</h2>
<p>In this example, we want to select the all cells as regions of interest and make sure no background is included in the selected region. To do that, we use the different arguments in <code>roi_select</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load image</span></span>
<span><span class="va">img2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/image_load.html">image_load</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'Image0003_.jpg'</span>, package <span class="op">=</span> <span class="st">'colocr'</span><span class="op">)</span><span class="op">)</span>       <span class="co"># merge</span></span>
<span></span>
<span><span class="co"># select ROI and show the results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">img2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_select.html">roi_select</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">85</span>,</span>
<span>             shrink <span class="op">=</span> <span class="fl">10</span>,</span>
<span>             clean <span class="op">=</span> <span class="fl">10</span>,</span>
<span>             n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_show.html">roi_show</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_colocr_files/figure-html/roi_subset-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="analyzing-a-collection-of-images-at-once">Analyzing a collection of images at once<a class="anchor" aria-label="anchor" href="#analyzing-a-collection-of-images-at-once"></a>
</h2>
<p>To process a collection of images at once, we first make a <code>list</code> of the image objects and pass it to the <code>roi_select</code>. Other arguments can be provided as a single value to be applied to all images or specific values for each image.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make a list of images</span></span>
<span><span class="va">fls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'Image0001_.jpg'</span>, package <span class="op">=</span> <span class="st">'colocr'</span><span class="op">)</span>,</span>
<span>         <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'Image0003_.jpg'</span>, package <span class="op">=</span> <span class="st">'colocr'</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">image_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/image_load.html">image_load</a></span><span class="op">(</span><span class="va">fls</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># call roi_select on multiple images</span></span>
<span><span class="va">image_list</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_select.html">roi_select</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">90</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_test.html">roi_test</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;         pcc</span></span>
<span><span class="co">#&gt; 1 0.9049954</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;         pcc</span></span>
<span><span class="co">#&gt; 1 0.8505968</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># make threshold input list</span></span>
<span><span class="va">thresholds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">90</span>, <span class="fl">95</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># call roi_select on multiple images and specific thresholds for each</span></span>
<span><span class="va">image_list</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_select.html">roi_select</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="va">thresholds</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_test.html">roi_test</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;         pcc</span></span>
<span><span class="co">#&gt; 1 0.9049954</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;        pcc</span></span>
<span><span class="co">#&gt; 1 0.762798</span></span></code></pre></div>
<p>The same applies of the other two functions; <code>roi_show</code> and <code>roi_check</code>. When a <code>list</code> of images is provided, they return same set of plots for each of the images.</p>
</div>
<div class="section level2">
<h2 id="reproducing-the-shiny-app-output">Reproducing the shiny app output<a class="anchor" aria-label="anchor" href="#reproducing-the-shiny-app-output"></a>
</h2>
<p>The interactive shiny app can be useful when trying the analysis for the first time. Or when choosing the appropriate input values to select the regions of interest. To make things easier for the users, we enabled exporting the input and the output from the shiny app. These can be used to report an analysis directly, or to reproduce the results using R code.</p>
<p>This section describes how to use the exported input and output tables from the app and using them to reproduce the same results. First, we start by loading <code>inputs_19.05.23_05.55.22.csv</code> which is the output of an analysis of two images performed by in the shiny app. Second, we load the <code>inputs_18.09.02_05.15.08.csv</code> which contains the input parameters used in that analysis. Then, we call <code>roi_select</code> and <code>roi_test</code> using these inputs. Finally, we compare the outputs form the app and the script.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># show the output</span></span>
<span><span class="va">stats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'colocr_app'</span>, <span class="st">'stats_19.05.23_05.55.21.csv'</span>, package <span class="op">=</span> <span class="st">'colocr'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">stats</span></span>
<span><span class="co">#&gt;   name          image roi       pcc       moc</span></span>
<span><span class="co">#&gt; 1  LC3 Image0001_.jpg   1 0.9119880 0.9834586</span></span>
<span><span class="co">#&gt; 2  LC3 Image0001_.jpg   2 0.8880337 0.9789110</span></span>
<span><span class="co">#&gt; 3  LC3 Image0003_.jpg   1 0.8445185 0.9448636</span></span>
<span><span class="co">#&gt; 4  LC3 Image0003_.jpg   2 0.8722429 0.9338876</span></span>
<span><span class="co">#&gt; 5  LC3 Image0003_.jpg   3 0.8537054 0.9550992</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># show the inputs</span></span>
<span><span class="va">inputs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'colocr_app'</span>, <span class="st">'inputs_19.05.23_05.55.22.csv'</span>, package <span class="op">=</span> <span class="st">'colocr'</span><span class="op">)</span>, stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">inputs</span></span>
<span><span class="co">#&gt;            image threshold shrink grow fill clean tolerance roi_num</span></span>
<span><span class="co">#&gt; 1 Image0001_.jpg        90      6    5    8     8       0.1       2</span></span>
<span><span class="co">#&gt; 2 Image0003_.jpg        90      8    5   10    10       0.1       3</span></span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># read images</span></span>
<span><span class="va">fls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">inputs</span><span class="op">$</span><span class="va">image</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="va">x</span>, package <span class="op">=</span> <span class="st">'colocr'</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="va">imgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/image_load.html">image_load</a></span><span class="op">(</span><span class="va">fls</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use the app input to the roi_select function</span></span>
<span><span class="va">rep_stats</span> <span class="op">&lt;-</span> <span class="va">imgs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_select.html">roi_select</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="va">inputs</span><span class="op">$</span><span class="va">threshold</span>,</span>
<span>             shrink <span class="op">=</span> <span class="va">inputs</span><span class="op">$</span><span class="va">shrink</span>,</span>
<span>             grow <span class="op">=</span> <span class="va">inputs</span><span class="op">$</span><span class="va">grow</span>,</span>
<span>             fill <span class="op">=</span> <span class="va">inputs</span><span class="op">$</span><span class="va">fill</span>,</span>
<span>             clean <span class="op">=</span> <span class="va">inputs</span><span class="op">$</span><span class="va">clean</span>,</span>
<span>             tolerance <span class="op">=</span> <span class="va">inputs</span><span class="op">$</span><span class="va">tolerance</span>,</span>
<span>             n <span class="op">=</span> <span class="va">inputs</span><span class="op">$</span><span class="va">roi_num</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_test.html">roi_test</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">'both'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rep_stats</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt;         pcc       moc</span></span>
<span><span class="co">#&gt; 1 0.9122681 0.9834711</span></span>
<span><span class="co">#&gt; 2 0.8881229 0.9789240</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt;         pcc       moc</span></span>
<span><span class="co">#&gt; 1 0.8445383 0.9448650</span></span>
<span><span class="co">#&gt; 2 0.8722704 0.9338842</span></span>
<span><span class="co">#&gt; 3 0.8537873 0.9551277</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># check the app and the package output is equal</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">pcc</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rep_stats</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">pcc</span>, <span class="va">rep_stats</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">pcc</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">stats</span><span class="op">$</span><span class="va">moc</span>, <span class="fl">2</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rep_stats</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">moc</span>, <span class="va">rep_stats</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">moc</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="description-of-the-co-localization-statistics">Description of the co-localization statistics<a class="anchor" aria-label="anchor" href="#description-of-the-co-localization-statistics"></a>
</h2>
<p>The following is a brief discussion of the theory and interpretations of different statistics that we used in this package as a measure of co-localization. For thorough and formal details, check this article by <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3074624/" class="external-link">Dunn et al.</a>.</p>
<div class="section level3">
<h3 id="pcc">PCC<a class="anchor" aria-label="anchor" href="#pcc"></a>
</h3>
<p>Pearson’s correlation coefficient is the co-variance of the pixel intensity from the two channels. The mean of the intensities is subtracted from each pixel which makes the coefficient independent of the background level.</p>
<p>The PCC is calculated as follows</p>
<p><span class="math display">\[
PCC = \frac{\sum_i{(R_i-\bar R)\times(G_i-\bar G)}}{\sqrt{\sum_i{(R_i-\bar R)^2\times\sum_i(G_i-\bar G)^2}}}
\]</span></p>
<p>Where <span class="math inline">\(R_i\)</span> and the <span class="math inline">\(G_i\)</span> is the intensities of the red and green channels and the <span class="math inline">\(\bar R\)</span> and <span class="math inline">\(\bar G\)</span> are the average intensities.</p>
<p>The values of PCC are between 1 and -1 for perfect correlations in the positive and negative directions respectively and 0 means no correlation.</p>
</div>
<div class="section level3">
<h3 id="moc">MOC<a class="anchor" aria-label="anchor" href="#moc"></a>
</h3>
<p>On the other hand, the Manders Overlap Coefficient doesn’t require subtraction of the mean. Therefore, the values are always between 0 and 1. Also, the MOC is independent from signal proportionality.</p>
<p><span class="math display">\[
MOC = \frac{\sum_i{(R_i\times G_i)}}{\sqrt{\sum_i{R_i^2\times\sum_i G_i^2}}}
\]</span> Where <span class="math inline">\(R_i\)</span> and the <span class="math inline">\(G_i\)</span> is the intensities of the red and green channels.</p>
</div>
</div>
<div class="section level2">
<h2 id="colocalization-benchmark-source">Colocalization Benchmark Source<a class="anchor" aria-label="anchor" href="#colocalization-benchmark-source"></a>
</h2>
<blockquote>
<p>The Colocalization Benchmark Source (CBS) is a free collection of downloadable images to test and validate the degree of colocalization of markers in fluorescence microscopy studies. It consists of computer-simulated images with exactly known (pre-defined) values of colocalization ranging from 0% to 90%. They can be downloaded as sets as well as separately.</p>
</blockquote>
<p>Here, we used two examples from the CBS to test the results of the analysis using <code>colocr</code>.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load image</span></span>
<span><span class="va">fl1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'example1.png'</span>, package <span class="op">=</span> <span class="st">'colocr'</span><span class="op">)</span></span>
<span><span class="va">ex1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/image_load.html">image_load</a></span><span class="op">(</span><span class="va">fl1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select and show regions of interest (based on the app)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ex1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_select.html">roi_select</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">90</span>, shrink <span class="op">=</span> <span class="fl">8</span>, n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_show.html">roi_show</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_colocr_files/figure-html/example1_roi-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate co-localization statistics</span></span>
<span><span class="co"># (expected pcc = 0.68, moc = 0.83)</span></span>
<span><span class="va">ex1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_select.html">roi_select</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">90</span>, shrink <span class="op">=</span> <span class="fl">8</span>, n <span class="op">=</span> <span class="fl">50</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_test.html">roi_test</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">'both'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;       pcc       moc </span></span>
<span><span class="co">#&gt; 0.6911481 0.9778421</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load image</span></span>
<span><span class="va">fl3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">'extdata'</span>, <span class="st">'example3.png'</span>, package <span class="op">=</span> <span class="st">'colocr'</span><span class="op">)</span></span>
<span><span class="va">ex3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/image_load.html">image_load</a></span><span class="op">(</span><span class="va">fl3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># select and show regioins of interest (based on the app)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ex3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_select.html">roi_select</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">90</span>, shrink <span class="op">=</span> <span class="fl">9</span>, grow <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="fl">10</span>, clean <span class="op">=</span> <span class="fl">10</span>, n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_show.html">roi_show</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="using_colocr_files/figure-html/example3_roi-1.png" width="384" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate co-localization statistics</span></span>
<span><span class="co"># (expected pcc = 0.61, moc = 0.71)</span></span>
<span><span class="va">ex3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_select.html">roi_select</a></span><span class="op">(</span>threshold <span class="op">=</span> <span class="fl">90</span>, shrink <span class="op">=</span> <span class="fl">9</span>, grow <span class="op">=</span> <span class="fl">1</span>, fill <span class="op">=</span> <span class="fl">10</span>, clean <span class="op">=</span> <span class="fl">10</span>, n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/roi_test.html">roi_test</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">colMeans</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;      pcc </span></span>
<span><span class="co">#&gt; 0.257307</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="acknowledgement">Acknowledgement<a class="anchor" aria-label="anchor" href="#acknowledgement"></a>
</h2>
<ul>
<li>The vignette images from <a href="https://www.researchgate.net/profile/Lai_Huyen_Trang" class="external-link">Lai Huyen Trang</a><br>
</li>
<li>The test examples from <a href="https://www.colocalization-benchmark.com/index.html" class="external-link">Colocalization Benchmark Source (CBS)</a><br>
</li>
<li>The implementation of the co-localization statistics from <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3074624/" class="external-link">Dunn et al.</a>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start top-4 bottom-8">
            <div class="col-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="https://github.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-github"></div></a>
                        <a href="https://github.com/ropenscilabs" target="_blank" class="external-link"><div class="icon fa fa-flask"></div></a>
                        <a href="https://hachyderm.io/@ropensci" target="_blank" class="external-link"><div class="icon fab fa-mastodon"></div></a>
                        <a href="https://vimeo.com/ropensci" target="_blank" class="external-link"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">About</h5>
                            <li><a href="https://ropensci.org/about" class="external-link">About rOpenSci</a></li>
                            <li><a href="https://ropensci.org/software-review" class="external-link">Software Review</a></li>
                            <li><a href="https://ropensci.org/about#team" class="external-link">Our Team</a></li>
                            <li><a href="https://ropensci.org/careers" class="external-link">Jobs</a></li>
                            <li><a href="https://ropensci.org/donate" class="external-link">Donate</a></li>
                            <li><a href="https://ropensci.org/contact" class="external-link">Contact Us</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Community</h5>
                            <li><a href="https://ropensci.org/community/" class="external-link">Our Community</a></li>
                            <li><a href="https://ropensci.org/commcalls/" class="external-link">Community calls</a></li>
                            <li><a href="https://ropensci.org/events/" class="external-link">Events</a></li>
                            <li><a href="https://discuss.ropensci.org/" class="external-link">Join the Discussion</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct" class="external-link">Code of conduct</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Resources</h5>
                            <li><a href="https://ropensci.org/packages/" class="external-link">Packages</a></li>
                            <li><a href="https://ropensci.org/usecases/" class="external-link">Use Cases</a></li>
                            <li><a href="https://ropensci.org/talks-papers/" class="external-link">Talks &amp; Publications</a></li>
                            <li><a href="https://docs.ropensci.org/" class="external-link">Documentation</a></li>
                            <li><a href="https://ropensci.org/news/" class="external-link">Newsletter</a></li>
                            <li><a href="https://ropensci.org/how-to-cite-ropensci/" class="external-link">Cite rOpenSci</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" class="external-link">NumFOCUS</a>.</p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->


    </footer>
</div>

  

  

  </body>
</html>
